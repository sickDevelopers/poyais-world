<script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"></script>

<script>
    var socket = io("http://localhost:3000");

    let initialState = []
    let currentState = []

    socket.on('initial-state', (data) => {
        initialState = JSON.parse(data);
    });

    socket.on('state', (data) => {
        currentState = JSON.parse(data);
    })

    function setup() {
        createCanvas(1000, 1000);
    }

    function draw() {
        background(51);

        // console.log(currentState);

        initialState
            .filter(entity => entity.type !== "human")
            .forEach(building => {
                fill("red");
                square(building.position[0] - 20, building.position[1]- 20, 40);
            })

        currentState.forEach(entity => {
            console.log(entity)
            fill("white")
            circle(entity.position[0],entity.position[1],10);
        })
    }

</script>